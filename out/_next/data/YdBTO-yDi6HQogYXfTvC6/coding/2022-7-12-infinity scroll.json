{"pageProps":{"frontMatter":{"title":"무한 스크롤(infinity scroll)","description":null,"tags":["리액트 코드(+React)"],"publishedDate":"2022/07/12","lastModifiedAt":"2022/07/12"},"markdownBody":"\n# 무한 스크롤(infinity scroll)\n\n브라우저의 스크롤이 화면의 끝에 갔을 때 자료를 더 불러와서 정보를 더 표현하는 기능\n\n- 한 번에 화면 크기 정도의 자료를 불러오고 필요할 때(화면 끝에 갔을 때) 더 정보를 불러온다.\n- 백엔드에서 받을 자료를 조금씩 요청하기 때문에 데이터량을 절약한다.\n- 백엔드에서 자료를 조금씩 받기 때문에 클라이언트의 부하가 감소한다.\n\n```tsx\n// useIntersectionObserver.ts\nimport { useEffect } from \"react\";\n\nconst options = {\n  root: null, // 뷰포트로 사용할 요소, 기본값은 브라우저의 뷰포트. react의 useRef나 querySelector로 html element를 정할 수 있다\n  rootMargin: \"0px\", // 기본값은 0. 단위는 px나 % 사용\n  threshold: 0.5, // 요소의 몇 %가 보일때 작동할 것인지(0~1 사이의 값)\n};\n\nconst useIntersectionObserver = (\n  ref: React.RefObject<HTMLDivElement>,\n  calback: () => void\n) => {\n  const intersectionCalback = ([entry]: IntersectionObserverEntry[]) => {\n    if (entry.isIntersecting) calback();\n  };\n  useEffect(() => {\n    const observer = new IntersectionObserver(intersectionCalback, options);\n    if (ref.current) {\n      observer.observe(ref.current);\n    }\n    return () => observer.disconnect();\n  }, [ref]);\n  return [ref];\n};\nexport default useIntersectionObserver;\n\n// ...\n\n// Home.tsx\nfunction Home() {\n  const { getMovies, movies } = useMovie();\n  const [pageNumber, setPageNumber] = useState(1);\n\n  const intersectionRef = useRef < HTMLDivElement > null;\n  const intersectionCalback = () => {\n    // 2. setPageNumber가 작동한다\n    setPageNumber((prev) => prev + 1);\n  };\n  useIntersectionObserver(intersectionRef, intersectionCalback);\n\n  useEffect(() => {\n    // 3. setPageNumber가 작동하면 pageNumber를 useEffect가 감지하고 변한 pageNumber로 getMovies를 수행한다\n    getMovies(pageNumber);\n  }, [pageNumber]);\n\n  return (\n    <div>\n      <Movies>\n        // 4. getMovies가 새로운 movies를 반환하고 Movie가 추가된다\n        {movies?.map((movie) => (\n          <Movie key={movie.id} movie={movie} />\n        ))}\n      </Movies>\n      // 1. IntersectionArea이 뷰포트에 나타나면,\n      <IntersectionArea ref={intersectionRef} />\n    </div>\n  );\n}\n```\n"},"__N_SSG":true}